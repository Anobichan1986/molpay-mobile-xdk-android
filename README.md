<!--
# license: Copyright Â© 2011-2016 MOLPay Sdn Bhd. All Rights Reserved. 
-->

# molpay-mobile-xdk-android

This is the complete and functional MOLPay Android payment module that is ready to be implemented into Android Studio through gradle from JCenter/Maven repository as a MOLPayXDK module. An example application project 
(MOLPayXdkExample) is provided for MOLPayXDK framework integration reference.

## Recommended configurations

    - Minimum Android SDK Version: 23 ++

    - Minimum Android API level: 16 ++

    - Minimum Android target version: Android 4.1

## MOLPay Android Caveats

    Credit card payment channel is not available in Android 4.1, 4.2, and 4.3. due to lack of latest security (TLS 1.2) support on these Android platforms natively.

## Installation

    Step 1 - Add compile 'com.molpay:molpay-mobile-xdk-android:<put latest release version here>' to dependencies in application build.gradle

    Step 2 - Add import com.molpay.molpayxdk.MOLPayActivity;

    Step 3 - Add the result callback function to get return results when the payment activity ended,
    
    @Override
    protected void onActivityResult(int requestCode, int resultCode, Intent data)
    {
        if (requestCode == MOLPayActivity.MOLPayXDK && resultCode == RESULT_OK){
            Log.d(MOLPayActivity.MOLPAY, "MOLPay result = "+data.getStringExtra(MOLPayActivity.MOLPayTransactionResult));
        }
    }
    
    =========================================
    Sample transaction result in JSON string:
    =========================================
    
    {"status_code":"11","amount":"1.01","chksum":"34a9ec11a5b79f31a15176ffbcac76cd","pInstruction":0,"msgType":"C6","paydate":1459240430,"order_id":"3q3rux7dj","err_desc":"","channel":"Credit","app_code":"439187","txn_ID":"6936766"}
    
    Parameter and meaning:
    
    "status_code" - "00" for Success, "11" for Failed, "22" for *Pending. 
    (*Pending status only applicable to cash channels only)
    "amount" - The transaction amount
    "paydate" - The transaction date
    "order_id" - The transaction order id
    "channel" - The transaction channel description
    "txn_ID" - The transaction id generated by MOLPay
    
    * Notes: You may ignore other parameters and values not stated above
    
    =====================================
    * Sample error result in JSON string:
    =====================================
    
    {"Error":"Communication Error"}
    
    Parameter and meaning:
    
    "Communication Error" - Error starting a payment process due to several possible reasons, please contact MOLPay support should the error persists.
    1) Internet not available
    2) API credentials (username, password, merchant id, verify key)
    3) MOLPay server offline.

## Prepare the Payment detail object

    HashMap<String, Object> paymentDetails = new HashMap<>();
        
        // Mandatory String. A value not less than '1.00'
        paymentDetails.put(MOLPayActivity.mp_amount, "1.10"); 
        
        // Mandatory String. Values obtained from MOLPay
        paymentDetails.put(MOLPayActivity.mp_username, "username");
        paymentDetails.put(MOLPayActivity.mp_password, "password");
        paymentDetails.put(MOLPayActivity.mp_merchant_ID, "merchantid");
        paymentDetails.put(MOLPayActivity.mp_app_name, "appname");
        paymentDetails.put(MOLPayActivity.mp_verification_key, "vkey123");
    
        // Mandatory String. Payment values
        paymentDetails.put(MOLPayActivity.mp_order_ID, "orderid123");
        paymentDetails.put(MOLPayActivity.mp_currency, "MYR");
        paymentDetails.put(MOLPayActivity.mp_country, "MY");
        
        // Optional String.
        paymentDetails.put(MOLPayActivity.mp_channel, "multi");
        paymentDetails.put(MOLPayActivity.mp_bill_description, "billdesc");
        paymentDetails.put(MOLPayActivity.mp_bill_name, "billname");
        paymentDetails.put(MOLPayActivity.mp_bill_email, "email@domain.com");
        paymentDetails.put(MOLPayActivity.mp_bill_mobile, "+1234567");
        paymentDetails.put(MOLPayActivity.mp_channel_editing, false);
        paymentDetails.put(MOLPayActivity.mp_editing_enabled, false);
    
        // For transaction request use only, do not use this on payment process
        paymentDetails.put(MOLPayActivity.mp_transaction_id, "");
        paymentDetails.put(MOLPayActivity.mp_request_type, "");

## Start the payment module

    startActivityForResult(intent, MOLPayActivity.MOLPayXDK);

## Transaction request service (optional)

    Step 1 - import com.molpay.molpayxdk.MOLPayService

    Step 2 - Prepare the Payment detail object

    Step 3 - MOLPayService mpservice = new MOLPayService();

    Step 4 - 
    mpservice.transactionRequest(paymentDetails, new MOLPayService.Callback() {
            @Override
            public void onTransactionRequestCompleted(String result) {
                // result return in json;
            }
            @Override
            public void onTransactionRequestFailed(String error) {
                // error return in json;
            }
        });

## Support

Submit issue to this repository or email to our support@molpay.com

Merchant Technical Support / Customer Care : support@molpay.com<br>
Sales/Reseller Enquiry : sales@molpay.com<br>
Marketing Campaign : marketing@molpay.com<br>
Channel/Partner Enquiry : channel@molpay.com<br>
Media Contact : media@molpay.com<br>
R&D and Tech-related Suggestion : technical@molpay.com<br>
Abuse Reporting : abuse@molpay.com